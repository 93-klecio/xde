<!DOCTYPE html>
<html>
  <head>
    <title>Exponent XDE</title>
    <link rel="stylesheet" href="./bootstrap-3.3.5.min.css" />
    <link rel="stylesheet" href="./xde.css" />
    <link rel="stylesheet" href="../node_modules/react-virtualized/styles.css" />
    <script>
      (() => {
        'use strict';
        const ElectronCookies = require('@exponent/electron-cookies');
        ElectronCookies.enable({ origin: 'https://xde.exp.host' });
      })();

      // Amplitude
      (function(e,t){var n=e.amplitude||{_q:[],_iq:{}};var r=t.createElement("script");r.type="text/javascript";
      r.async=true;r.src="https://d24n15hnbwhuhn.cloudfront.net/libs/amplitude-3.0.2-min.gz.js";
      r.onload=function(){e.amplitude.runQueuedFunctions()};var i=t.getElementsByTagName("script")[0];
      i.parentNode.insertBefore(r,i);function s(e,t){e.prototype[t]=function(){this._q.push([t].concat(Array.prototype.slice.call(arguments,0)));
      return this}}var o=function(){this._q=[];return this};var a=["add","append","clearAll","prepend","set","setOnce","unset"];
      for(var u=0;u<a.length;u++){s(o,a[u])}n.Identify=o;var c=function(){this._q=[];return this;
      };var p=["setProductId","setQuantity","setPrice","setRevenueType","setEventProperties"];
      for(var l=0;l<p.length;l++){s(c,p[l])}n.Revenue=c;var d=["init","logEvent","logRevenue","setUserId","setUserProperties","setOptOut","setVersionName","setDomain","setDeviceId","setGlobalUserProperties","identify","clearUserProperties","setGroup","logRevenueV2","regenerateDeviceId"];
      function v(e){function t(t){e[t]=function(){e._q.push([t].concat(Array.prototype.slice.call(arguments,0)));
      }}for(var n=0;n<d.length;n++){t(d[n])}}v(n);n.getInstance=function(e){e=(!e||e.length===0?"$default_instance":e).toLowerCase();
      if(!n._iq.hasOwnProperty(e)){n._iq[e]={_q:[]};v(n._iq[e])}return n._iq[e]};e.amplitude=n;
      })(window,document);
    </script>

    <!-- Intercom -->
    <script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/j3i1r6vl';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()</script>

    <script>
      window.IntercomUpdateStyle = function() {
        var intercomStyleInterval = setInterval(function() {
          var frame = document.querySelector('.intercom-launcher-frame');
          if (frame) {
            let intercomContainer = frame.contentDocument.querySelector('#intercom-container');
            if (intercomContainer) {
              intercomContainer.style.opacity = 0.5;
              clearInterval(intercomStyleInterval);
            }
          }
        }, 100);
      }
    </script>
  </head>
  <body>
    <div id="app">
      <a id="app-loading">Loading...</a>
    </div>
    <script>
      (() => {
        'use strict';
        const { remote } = require('electron');
        document.getElementById('app-loading').addEventListener('click', () => {
          remote.getCurrentWindow().openDevTools();
        }, false);

        const React = require('react');
        const ReactDOM = require('react-dom');
        const App = require('../build/ui/App');
        let rootElement = React.createElement(App, {
          amplitude,
        });
        let rootNode = document.getElementById('app');
        ReactDOM.render(rootElement, rootNode);

        window.addEventListener('beforeunload', () => {
          ReactDOM.unmountComponentAtNode(rootNode);
        });
      })();
    </script>
  </body>
</html>
