{"version":3,"sources":["application/Exp.js"],"names":[],"mappings":"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","file":"application/Exp.js","sourcesContent":["let jsonFile = require('@exponent/json-file');\nlet existsAsync = require('exists-async');\nlet fs = require('fs');\nlet fsExtra = require('fs-extra');\nlet mkdirp = require('mkdirp');\nlet path = require('path');\n\nlet userSettings = require('./userSettings');\n\nlet TEMPLATE_ROOT = path.resolve(path.join(__dirname, '../../template'));\n\nfunction NewExpError(code, message) {\n  let err = new Error(message);\n  err.code = code;\n  err._isNewExpError;\n  return err;\n}\n\nasync function determineEntryPoint(root) {\n  let pkgJson = jsonFile(path.join(root, 'package.json'));\n  let main = await pkgJson.getAsync('main', 'index.js');\n  // console.log(\"main=\", main);\n  return main;\n}\n\nasync function createNewExpAsync(root, info, opts) {\n\n  let pp = path.parse(root);\n  let name = pp.name;\n\n  // opts = opts || {force: true};\n  opts = opts || {};\n\n  let author = await userSettings.getAsync('email', undefined);\n\n  let data = Object.assign({\n    name,\n    version: '0.0.0',\n    description: \"Hello Exponent!\",\n    main: 'main.js',\n    author,\n    //license: \"MIT\",\n    // scripts: {\n    //   \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n    // },\n  }, info);\n\n  let pkgJson = jsonFile(path.join(root, 'package.json'));\n\n  let exists = await existsAsync(pkgJson.file);\n  if (exists && !opts.force) {\n    throw NewExpError('WONT_OVERWRITE_WITHOUT_FORCE', \"Refusing to create new Exp because package.json already exists at root\");\n  }\n\n  await mkdirp.promise(root);\n\n  let result = await pkgJson.writeAsync(data);\n\n  await fsExtra.promise.copy(TEMPLATE_ROOT, root);\n\n  // Custom code for replacing __NAME__ in main.js\n  let mainJs = await fs.readFile.promise(path.join(TEMPLATE_ROOT, 'main.js'), 'utf8');\n  let customMainJs = mainJs.replace(/__NAME__/g, data.name);\n  result = await fs.writeFile.promise(path.join(root, 'main.js'), customMainJs, 'utf8');\n\n  return data;\n\n}\n\nmodule.exports = {\n  determineEntryPoint,\n  createNewExpAsync,\n};\n"],"sourceRoot":"/source/"}