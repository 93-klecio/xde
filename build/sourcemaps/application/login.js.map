{"version":3,"sources":["application/login.js"],"names":[],"mappings":";;;;;;IAKe,mBAAmB,qBAAlC,WAAmC,IAAI,EAAE;;;AAGvC,MAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,QAAQ,CAAC;;AAElC,MAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;AACpC,UAAM,IAAI,KAAK,CAAC,wEAAwE,CAAC,CAAC;GAC3F;;AAED,MAAI,cAAc,GAAG,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;;AAE1D,MAAI,IAAI,GAAG,eAAc,EAAE,EAAE,IAAI,EAAE,EAAC,cAAc,EAAd,cAAc,EAAC,CAAC,CAAC;AACrD,SAAO,IAAI,CAAC,QAAQ,CAAC;;;;AAIrB,MAAI,MAAM,GAAG,MAAM,GAAG,CAAC,eAAe,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;;AAExD,MAAI,MAAM,CAAC,IAAI,EAAE;AACf,WAAO,MAAM,CAAC,IAAI,CAAC;;AAEnB,UAAM,YAAY,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AAC3C,WAAO,MAAM,CAAC;GACf,MAAM;AACL,WAAO,IAAI,CAAC;GACb;CAEF;;AA/BD,IAAI,GAAG,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;AAC3B,IAAI,QAAQ,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACrC,IAAI,YAAY,GAAG,OAAO,CAAC,gBAAgB,CAAC,CAAC;;AA+B7C,MAAM,CAAC,OAAO,GAAG;AACf,qBAAmB,EAAnB,mBAAmB;CACpB,CAAC","file":"application/login.js","sourcesContent":["\nlet Api = require('./Api');\nlet password = require('./password');\nlet userSettings = require('./userSettings');\n\nasync function loginOrAddUserAsync(args) {\n\n  // Default to `client` since xde is a client\n  args.type = args.type || 'client';\n\n  if (!args.username || !args.password) {\n    throw new Error(\"Both `username` and `password` are required to login or add a new user\");\n  }\n\n  let hashedPassword = password.hashPassword(args.password);\n\n  let data = Object.assign({}, args, {hashedPassword});\n  delete data.password;\n\n  // console.log(\"data=\", data);\n\n  let result = await Api.callMethodAsync('adduser', data);\n  // console.log(\"result=\", result);\n  if (result.user) {\n    delete result.type;\n    // console.log(\"Login as\", result);\n    await userSettings.mergeAsync(result.user);\n    return result;\n  } else {\n    return null;\n  }\n\n}\n\nmodule.exports = {\n  loginOrAddUserAsync,\n};\n"],"sourceRoot":"/source/"}